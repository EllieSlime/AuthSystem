{% extends "core/base.html" %}
{% block title %}Мои лобби - SmartHome{% endblock %}

{% block content %}

<section class="account">
    <div class="container">
        <h2 class="section-title">Мои лобби</h2>

        <div class="account-container">
            <div class="sidebar">
                <ul class="sidebar-nav">
                    <li><a href="#" class="active"><i class="fas fa-building"></i> Мои лобби</a></li>
                    <li><a href="{% url 'settings' %}"><i class="fas fa-cog"></i> Настройки профиля</a></li>
                </ul>
            </div>

            <div class="account-content">
                <!-- Строка поиска -->
                <form method="get" style="margin-bottom: 30px;">
                    <input type="text"
                           name="code"
                           value="{{ search_query|default:'' }}"
                           class="form-input"
                           placeholder="Введите 6-значный код лобби..."
                           style="max-width: 300px; display: inline-block; margin-right: 10px;">
                    <button type="submit" class="btn btn-small">Найти</button>
                </form>
                {% if error_message %}
                    <div class="error-message" style="color: white; margin-bottom: 20px;">
                        {{ error_message }}
                    </div>
                {% endif %}

                <div class="devices-grid">
                    {% for lobby in lobbies %}
                    <div class="device-card">
                        <div class="device-header">
                            <div class="device-icon">
                                <i class="fas {{ lobby.icon }}"></i>
                            </div>
                            <div class="device-title">{{ lobby.name }}</div>
                            {% if lobby.is_active %}
                                <div class="device-status status-online">Online</div>
                            {% else %}
                                <div class="device-status status-offline">Offline</div>
                            {% endif %}
                        </div>
                        <div class="device-info">
                            Код: {{ lobby.code }} <br>
                            Участников: {{ lobby.memberships.count }}
                        </div>
                        <div class="device-actions">
                            <a href="{% url 'lobby_set' lobby.id %}" class="btn btn-small btn-outline">Параметры</a>
                            <a href="{% url 'lobby_detail' lobby.id %}" class="btn btn-small">Войти</a>
                        </div>
                    </div>
                    {% endfor %}

                    <!-- Карточка для добавления нового лобби (всегда последняя) -->
                    <div class="device-card add-device-card">
                        <div class="device-header">
                            <div class="device-icon">
                                <i class="fas fa-plus"></i>
                            </div>
                            <div class="device-title">Добавить лобби</div>
                        </div>
                        <div class="device-info">
                            Создайте новое лобби или присоединитесь к существующему
                        </div>
                        <div class="device-actions">
                            <a href="{% url 'lobby_cre' %}" class="btn btn-small">Создать новое</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}